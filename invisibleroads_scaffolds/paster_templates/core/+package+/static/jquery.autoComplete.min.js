$.fn.autoComplete=function(e){var e=$.extend({},{delay:125,filter:function(c,b){var d=RegExp(b.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i");return $.grep(c,function(b){return d.test(b)})},formatResult:function(c){return c},maxResultCount:10,minCharacterCount:2,separator:null,source:[]},e),d=$("#autoCompleteResults");d.length||(d=$("<ul>",{id:"autoCompleteResults",style:"display:none"}).appendTo("body"));var f=e.separator,i,j;f?(i=function(c){c=c.split(f);return $.trim(c[c.length-1])},j=function(c,
b){var d=c.split(f);d[d.length-1]=b;return $.map(d,$.trim).join(f)+f}):(i=function(c){return $.trim(c)},j=function(c,b){return b});return $(this).each(function(){function c(a){var c=d.children(),e=c.length-1;0>a?a=0:a>e&&(a=e);h!=a&&(b.trigger("itemBlur",[c[h]]),h=a);b.trigger("itemFocus",[c[a]])}var b=$(this),f,h;b.prop("autocomplete","off").off(".ac").on({"keyup.ac":function(a){a=a.keyCode;if(40==a)d.is(":visible")&&c(h+1);else if(38==a)d.is(":visible")&&c(h-1);else if(13==a)d.is(":visible")&&(a=
d.children(),b.trigger("itemSelect",[a[h]]));else{var a=b.val(),g=a.length;f!=g&&(f=g,i(a).length>=e.minCharacterCount?setTimeout(function(){b.trigger("autoPrompt")},e.delay):b.trigger("inputBlur"))}},"keydown.ac":function(a){a=a.keyCode;if(13==a)return!1;if(27==a&&d.is(":visible"))return b.trigger("inputBlur"),!1},"autoPrompt.ac":function(){var a=b.val(),g=e.source,g="string"==typeof g?eval(g):g,a=e.filter(g,i(a)).splice(0,e.maxResultCount);a.length?(d.html($.map(a,function(a){return"<li>"+e.formatResult(a)+
"</li>"}).join("")).css({position:"absolute",top:function(){return b.offset().top+b.height()},left:function(){return b.offset().left}}).undelegate(".ac").delegate("li",{"mouseenter.ac":function(){c($(this).prevAll().length)},"mouseleave.ac":function(){b.trigger("itemBlur",[this])},"mousedown.ac":function(){b.trigger("itemSelect",[this])}}).show(),c(0)):d.hide()},"itemFocus.ac":function(a,b){$(b).addClass("autoCompleteSelection")},"itemBlur.ac":function(a,b){$(b).removeClass("autoCompleteSelection")},
"itemSelect.ac":function(a,c){var d=j(b.val(),$(c).text());b.val(d).trigger("inputBlur");setTimeout(function(){b.focus()},0);f=d.length},"inputBlur.ac":function(){d.hide()}});$(document).off(".ac").on("mouseup.ac focusin.ac",function(){b.trigger("inputBlur")})})};